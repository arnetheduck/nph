<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The nph style - nph</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="open-in.css">
        <link rel="stylesheet" href="./mdbook-admonish.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">User guide</li><li class="chapter-item expanded "><a href="installation.html"><strong aria-hidden="true">2.</strong> Installation</a></li><li class="chapter-item expanded "><a href="usage.html"><strong aria-hidden="true">3.</strong> Usage</a></li><li class="chapter-item expanded "><a href="style.html" class="active"><strong aria-hidden="true">4.</strong> The nph style</a></li><li class="chapter-item expanded "><a href="faq.html"><strong aria-hidden="true">5.</strong> FAQ</a></li><li class="chapter-item expanded affix "><li class="part-title">Developer guide</li><li class="chapter-item expanded "><a href="test.html"><strong aria-hidden="true">6.</strong> Test suite</a></li><li class="chapter-item expanded "><a href="book.html"><strong aria-hidden="true">7.</strong> Updating this book</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">nph</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/arnetheduck/nph/" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="the-nph-style"><a class="header" href="#the-nph-style">The <code>nph</code> style</a></h1>
<p>As outlined in the <a href="./introduction.html#priorities">introduction</a>, <code>nph</code> strives
to maintain correctness and consistency across various language constructs with
a preference for styles that work well for collaboration.</p>
<p>This section of the book documents some of the style choices and why they were
made.</p>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#lists">Lists</a>
<ul>
<li><a href="#parameter-lists">Parameter lists</a></li>
<li><a href="#infix-operators">Infix operators</a></li>
</ul>
</li>
<li><a href="#expressions">Expressions</a></li>
</ul>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p><code>nph</code> generally approaches formatting by considering several choices of
formatting and choosing a reasonable one based on a number of heuristics.</p>
<p>To get an idea what the format looks like, here's a typical proc definition -
everything fits on one line, nice!</p>
<pre><code class="language-nim">proc function(par0: SomeType): bool =
  ...
</code></pre>
<p>If we add more arguments, it starts getting long - nph will try with a version
where the arguments sit on a line of their own:</p>
<pre><code class="language-nim">proc function(
    par0: SomeType, par1: SomeType
): bool =
  ...
</code></pre>
<p>The above idea extends to most formatting: if something is simple, format it in
a simple way - if not, use a bit of style to break down what's going on into
more easily consumable pieces - here's a function with several information-dense
parameters and a pragma:</p>
<pre><code class="language-nim">proc function(
    par0: SomeType,
    par1, par2: SomeOtherType,
    par3 = default(SomeType),
): bool {.inline.} =
  ...
</code></pre>
<div id="admonition-example-styling" class="admonition admonish-info">
<div class="admonition-title">
<p>Example styling</p>
<p><a class="admonition-anchor-link" href="#admonition-example-styling"></a></p>
</div>
<div>
<p>The examples are illustrative and not based on exact rendering semantics - in
particular, a different line length was used to make the point</p>
</div>
</div>
<h2 id="lists"><a class="header" href="#lists">Lists</a></h2>
<p>Lists appear frequently in source code: import modules, parameter lists, arrays
and sequence initializers, function call parameters, etc etc.</p>
<p>Generally, list rendering is done according to a number of heuristics, striving
to balance information density with the use of available screen space.</p>
<p>If the whole list fits on the current line, it is rendered in-place. Short
sequences, single-parameter functions etc usually fit into this category:</p>
<pre><code class="language-nim">import dir/module

const v = [1, 2, 3]

type T = proc(a, b: int)
</code></pre>
<p>If it doesnt fit from the current position, we try fitting it in one line on a
new line - this frequently happens with parameter lists and constants where the
name takes up space</p>
<pre><code class="language-nim">import
  dir/[module1, module2, module3, module4]

const mylongvariablename =
  [100000000, 200000000, 300000000]

proc function(
  param0: int, param1: int, param2: int
)
</code></pre>
<p>If the list still doesn't fit on a single line, we look at the contents to
choose between two styles.</p>
<p>If it contains complex complex values, we render one value per row - this
happens most often for function parameters and other information-dense constructs.</p>
<pre><code class="language-nim">import
  dir/[module1, module2, module3],
  dir2/[
    module4, module5, module6, module7,
    module8, module9,
  ]

let myVariable = [
  functionCall(a, b, c),
  functionCall(a, b, c, d),
]

functionCall(
  functionCall(a, b, c),
  functionCall(a, b, c, d),
)
</code></pre>
<div id="admonition-extra-separator" class="admonition admonish-info">
<div class="admonition-title">
<p>Extra separator</p>
<p><a class="admonition-anchor-link" href="#admonition-extra-separator"></a></p>
</div>
<div>
<p>In the long style, we'll insert an extra separator at the end where permissible -
this makes it easier to reorder entries and reduces git conflicts!</p>
</div>
</div>
<p>For simple values, we use a compact style that fits several items per row:</p>
<pre><code class="language-nim">const values = [
  10000000, 2000000000, 3000000000,
  40000000, 5000000000,
]

functionCall(
  10000000, 2000000000, 3000000000,
  40000000, 5000000000,
)
</code></pre>
<div id="admonition-what-is-simple" class="admonition admonish-info">
<div class="admonition-title">
<p>What is simple?</p>
<p><a class="admonition-anchor-link" href="#admonition-what-is-simple"></a></p>
</div>
<div>
<ul>
<li>literals (<code>2</code>, <code>&quot;string&quot;</code> etc)</li>
<li>simple identifiers (<code>myvar</code> etc)</li>
<li>dot expressions of the the above (<code>myObject.field</code>)</li>
</ul>
</div>
</div>
<h3 id="parameter-lists"><a class="header" href="#parameter-lists">Parameter lists</a></h3>
<p>Parameter lists, such as function parameters and generics, are rendered using
the above list style. In the AST, each parameter group is made up of 3
components: one or more names, a type and a default.</p>
<p>If both type and default are missing, we disambiguate parsing multiple names and
groups using a <code>;</code>.</p>
<pre><code class="language-nim"># Usually we can use comma to separate items
proc f(a, b: int, c: float)

# A semicolon is necessary to ensure `T` is interpreted as a type and not part
# of the `v: static int` identifier group
proc g[T; v: static int]

# Semicolons are also significant for type-less parameters - the following two
# templates parse to different ASTs:
template weare(a; b) = discard
template notthesame(a, b) = discard

# Semicolons cannot be used at all for inline procedures:
proc f(
  myParameter = 0,
  callback: SomeCallback = proc() =
    discard
  ,
  nextParameter = 1,
)
</code></pre>
<h3 id="infix-operators"><a class="header" href="#infix-operators">Infix operators</a></h3>
<p><code>nph</code> puts spaces around infix operators such as <code>and</code> and <code>..</code>.</p>
<p>Although NEP1 suggests not having spaces around <code>..</code> and <code>..&lt;</code> in particular,
this creates an exception to the normal infix spacing rules.</p>
<p>In spite of this recommendation, lots of code out there maintains spaces around
the operators which makes decision based on &quot;existing practice&quot; hard.</p>
<p>Adding to the complexity is in order to not break the AST, one would have to
take care to remove the spaces only in cases where the infix is not followed by
another operator (such as <code>-</code>) - this means that we <em>sometimes</em> have to put
spaces around these infixes and sometimes not, leading to irregularity.</p>
<p>Since there's no consensus in existing code at the time of writing, the rule is
irregular and causes implementation complexity, <code>nph</code> formats <code>..</code> and <code>..&lt;</code>
with spaces.</p>
<h2 id="expressions"><a class="header" href="#expressions">Expressions</a></h2>
<p>Expressions appear in many places, such as after certain keywords (<code>return</code>,
<code>yield</code>), as part of control flows (<code>if</code>, <code>while</code>), in assignments etc.</p>
<p>Whenever possible, <code>nph</code> will try to keep the full expression on a single line:</p>
<pre><code class="language-nim">let myvariable = shortexpression(abc)
</code></pre>
<p>If this is not possible, the second preference is to move the whole expression
to a new line, assuming it fits:</p>
<pre><code class="language-nim">let myvariable =
  someevenlongerexpression(abc, def)
</code></pre>
<p>If the expression still doesn't fit, we'll split it up on multiple lines:</p>
<pre><code class="language-nim">let myvariable = someevenlongerexpression(
  aaa, bbb, ccc, ddd
)
</code></pre>
<p>Certain expressions linked by related keywords that don't fit on a single line
will also be moved to a new line - for example, a multi-line <code>if</code>/<code>else</code> nested
in a <code>return</code> will be lined up like so:</p>
<pre><code class="language-nim">return
  if condition:
    complex(call)
  else:
    alsocomplex(call)
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/arnetheduck/nph//edit/master/docs/src/style.md">Edit this page on GitHub.</a></footer>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="usage.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="faq.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="usage.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="faq.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
